ffrom com.android.monkeyrunner import MonkeyRunner, MonkeyDevice, MonkeyImage
import commands
import sys
import random
import os



os.system("echo 'Starting Swarm'")
print "Connecting to Emulator"

device = MonkeyRunner.waitForConnection(5000,"emulator-5554")

#Sets up $REPORTROOT
os.system("REPORTS=./reports")
os.system("rm REPORTS")
os.system("mkdir REPORTS")

loop = 10
count = 0



def Rotate():
	MonkeyRunner.sleep(2)
	os.system("/scratch/xautomation-1.07/xte \"keydown Control_L\"")
	os.system("/scratch/xautomation-1.07/xte \"keydown F12\"")
	MonkeyRunner.sleep(1)
	os.system("/scratch/xautomation-1.07/xte \"keyup Control_L\"")
	os.system("/scratch/xautomation-1.07/xte \"keyup F12\"")
	MonkeyRunner.sleep(1)


while (count < loop):
	
	print "Test: ", count
	print "" 
	#Runs MonkeyUI Tester
	os.system("adb -e shell monkey -p org.mozilla.fennec -v  100 > REPORTS/Test"+`count`+".txt")

	#Logs actions and crashes
	os.system("grep -A 5 -h -r CRASH REPORTS > REPORTS/TestCrash"+`count`+".txt")
	
	Rotate()	
	
	MonkeyRunner.sleep(5)
	count = count + 1
	os.system("clear")	
	
	
print "end"
